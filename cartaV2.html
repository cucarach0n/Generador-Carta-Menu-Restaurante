<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<link href="https://fonts.googleapis.com/css?family=Lobster" rel="stylesheet"/>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.min.js"></script>
	
	<title>Document</title>
	<link rel="stylesheet" href="style.css">
	<style>
		@media (max-width: 992px) {
		  #generador {
			border-bottom-style: ridge !important;
		  }
		}
		@media (min-width: 993px) {
		  #generador {
			border-right-style: ridge !important;
		  }
		}
	</style>
</head>
<body>
	
    	<!--
    price start
    ============================ -->
	<div class="container ">
		<div class="row justify-content-center border border-success rounded border-2" >
			<div id="generador" class="col-12 col-lg-7 " style="padding: 10px;">
				<div class="container ">
					<div class="row justify-content-center">
						<div class="col-12 text-center">
							<h1 class="display-3">EL MIXTO</h1>
						</div>
					</div>
					<div class="row justify-content-center">
						<div class="col-6 col-sm-3 text-center">
							<img src="imagenes/logo_chef.png" class="img-fluid" alt="Logo el Mixto">
						</div>
					</div>
					<div class="row justify-content-center">
						<div class="col-12 text-center">
							<h1 class="display-6" style="margin-bottom: 0px;">Generador de Carta</h1>
						</div>
						<hr class="col-9"style="margin-bottom: 5px;">
						<hr class="col-7">
					</div>
					<div class="row justify-content-center">
						<div class="col-12 col-sm-12 col-md-2  text-center">
							<label for="inputPrecio" class="form-label">Precio Menu</label>
						</div>
						<div class="col-9 col-sm-6 col-md-5 col-lg-6 col-xl-5 text-end">
							<div class="input-group mb-3">
								<div class="input-group-prepend">
								  <span class="input-group-text">S/.</span>
								</div>
								
								<input class="form-control" list="datalistPrecio" id="inputPrecio" value="7.50" placeholder="Precio...">
								<div class="input-group-append">
									<input type="button" id="btnCambiarPrecio" onclick="cambiarPrecio();" value="Actualizar" class="btn btn-info">
								</div>
								<datalist id="datalistPrecio">
									<option value="6">
									<option value="6.5">
									<option value="7">
									<option value="7.5">
									<option value="8">
									<option value="8.5">
									<option value="9">
									<option value="9.5">
									<option value="10">
								</datalist>
							  </div>

							
						</div>
						<!--<div class="col-6 col-sm-2 text-start">
							<input type="button" id="btnCambiarPrecio" onclick="" value="Cambiar" class="btn btn-info">
						</div>-->
					</div>
					<div class="row justify-content-center" style="margin: 5px;">
						<div class="col-12 text-center">
							<div class="btn-group flex-wrap" role="group" aria-label="Basic radio toggle button group">
								<input type="radio" onclick="cambiarTipoProducto(1);" class="btn-check" name="options-outlined" id="btnEntrada" autocomplete="off" checked>
								<label class="btn btn-outline-danger" for="btnEntrada">Entrada</label>
								
								<input type="radio" onclick="cambiarTipoProducto(2);" class="btn-check" name="options-outlined" id="btnSegundo" autocomplete="off">
								<label class="btn btn-outline-danger" for="btnSegundo">Segundo</label>
								
								<input type="radio" onclick="cambiarTipoProducto(3);" class="btn-check" name="options-outlined" id="btnExtra" autocomplete="off">
								<label class="btn btn-outline-danger" for="btnExtra">Extra</label>
	
								<input type="radio" onclick="cambiarTipoProducto(4);" class="btn-check" name="options-outlined" id="btnBebida" autocomplete="off">
								<label class="btn btn-outline-danger" for="btnBebida">Bebidas</label>
							</div>
							
						</div>
					</div>
					<form id="frmMenu">
						<div class="row justify-content-center" style="padding: 5px;">
							<div class="col-12 col-sm-2 text-center">
								<label for="txtNombreProducto" class="form-label">Nombre Producto</label>
							</div>
							<div class="col-9 col-sm-4 text-center">
								<input type="text" id="txtNombreProducto" class="form-control" aria-label="Default" aria-describedby="inputGroup-sizing-default" required>
							</div>
							<div class="col-12 col-sm-2 text-center" id="lblPrecioProducto" style="display: none;">
								<label for="txtPrecioProducto" class="form-label">Precio Producto</label>
							</div>
							<div class="col-4 col-sm-3 col-lg-3 text-center" id="lblTextPrecioProducto" style="display: none;">
								<div class="input-group mb-3">
									<div class="input-group-prepend">
										<span class="input-group-text">S/.</span>
									</div>
									<input type="text" id="txtPrecioProducto" class="form-control" aria-label="Default" aria-describedby="inputGroup-sizing-default">
								</div>
								
							</div>
						</div>
						<div class="row justify-content-center" style="padding: 5px;">
							<div class="col-12 text-center">
								<input type="submit" id="btnAgregarProducto" onclick="agregarProducto(event);" value="Agregar" class="btn btn-success">
								<input type="button" id="btnLimpiar" onclick="" value="Limpiar" class="btn btn-success">
							</div>
						</div>
					</form>
					<div class="row justify-content-center" style="padding: 5px;">
						<div class="col-4 text-center">
							<input type="button" id="btnDownload" onclick="print();" value="Download" class="btn btn-primary">
						</div>
						<div class="col-4 text-center">
							<input type="button" id="btnLimpiar" onclick="limpiarCanvas();" value="Limpiar" class="btn btn-primary">
						</div>
						<div class="col-4 text-center">
							<input type="button" id="btnDibujar" onclick="draw();" value="Dibujar" class="btn btn-primary">
						</div>
					</div>
				</div>
				
			</div>
			<div class="col-12 col-lg-5" style="padding: 10px;">
				<div class="container ">
					<div class="row ">
						<div class="col-7 text-end">
							<h2>
								MENÚ
							</h2>
						</div>
						<div class="col-5 text-end">
							<h2 id="lblPrecio">
								s/.7.50
							</h2>
						</div>
						
					</div>
					<div class="row justify-content-center">
						<hr class="col-9"style="margin-bottom: 5px;">
						<hr class="col-7">
					</div>
					<div class="row justify-content-center">
						<div class="col-12">
							<label for="selectEntrada" style="font-weight: bold;" class="form-label">Entrada</label>
							<ul class="list-group" id="selectEntrada" >
								<li class="list-group-item d-flex justify-content-between align-items-center">
									Vacio...
								</li>
							</ul>	
						</div>
						<div class="col-12">
							<label for="selectSegundo" style="font-weight: bold;" class="form-label">Segundo</label>
							<ul class="list-group" id="selectSegundo" >
								<li class="list-group-item d-flex justify-content-between align-items-center">
									Vacio...
								</li>
							</ul>	
						</div>
						<div class="col-12">
							<label for="selectExtra" style="font-weight: bold;" class="form-label">Extra</label>
							<ul class="list-group" id="selectExtra" >
								<li class="list-group-item d-flex justify-content-between align-items-center">
									Vacio...
								</li>
							</ul>	
						</div>
						<div class="col-12">
							<label for="selectBebida" style="font-weight: bold;" class="form-label">Bebida</label>
							<ul class="list-group" id="selectBebida" >
								<li class="list-group-item d-flex justify-content-between align-items-center">
									Vacio...
								</li>
							</ul>	
						</div>
						<div class="col-12 text-center" >
							<label for="btnGroupOpciones"  style="margin-top: 5px;margin-bottom: 0px;" class="form-label">Opciones</label>
						</div>
						<div class="col-12 text-center">
							
							<div id="btnGroupOpciones" class="btn-group btn-group-lg" role="group" aria-label="Basic mixed styles example">
								<button type="button" class="btn btn-success">
									<i class="bi bi-pencil-fill"></i>
								</button>
								<button type="button" class="btn btn-danger">
									<i class="bi bi-trash-fill"></i>
								</button>
								<button type="button" class="btn btn-info">
									<i class="bi bi-caret-up-fill"></i>
								</button>
								<button type="button" class="btn btn-primary">
									<i class="bi bi-caret-down-fill"></i>
								</button>
							</div>
						</div>
						
					</div>
				</div>
			</div>
		</div>
		
		<div class="row justify-content-center" style="padding: 5px;">
			<div class="col-12 text-center">
				<div class="contenedor">
					<canvas class="lienzo" id="canvasCarta" width="1123" height="794" style="border: red 5px dotted;"></canvas>
				</div>
				
			</div>
		</div>
		
	</div>
	<script src="imagenFondo.js"></script>
	<script type="text/javascript">
		//tipo producto
		var tipoProducto = 1;
		//precio del menu
		var precioMenu = 7.5;
		// arreglos de productos
		var arrayEntradas = ['Prueba','Prueba2','Prueba3'];
		var arraySegundos = [['Prueba1',7],['Prueba2',8]];
		var arrayExtras = [['Prueba1',7.5],['Lomo Saltado',88.99],['aaaaaaaaaaaaaaa',8]];//max 24 caracteres
		var arrayBebidas = [['Prueba1',7],['Prueba2',88.54]];
		//selects de la carta
		const selectEntradas = document.getElementById('selectEntrada');
		const selectSegundos = document.getElementById('selectSegundo');
		const selectExtras = document.getElementById('selectExtra');
		const selectBebidas = document.getElementById('selectBebida');
		//label precio
		const labelPrecio = document.getElementById('lblPrecio');
		//construyendo item menu
		/*
			<li class="list-group-item d-flex justify-content-between align-items-center">
				A list item
			</li>
		*/
		const itemMenu = document.createElement('li');
		itemMenu.className = 'list-group-item d-flex justify-content-between align-items-center';
		//construyendo item menu con precio
		/*
			<li class="list-group-item d-flex justify-content-between align-items-center">
				A list item
				<span class="badge bg-primary rounded-pill">14</span>
			</li>
		*/
		const itemMenuConPrecio = document.createElement('li');
		itemMenuConPrecio.className = 'list-group-item d-flex justify-content-between align-items-center';
		const spanPrecio = document.createElement('span');
		spanPrecio.className = 'badge bg-primary rounded-pill';
		
		//funcion para agregar producto al menu
		function agregarProducto(evt){
			
			//llamando required del input nombreProducto
			
			if(document.getElementById('txtNombreProducto').checkValidity()){
				evt.preventDefault();
				//validando tipo producto a agregar
				var nombreProducto = document.getElementById('txtNombreProducto').value;
				switch(tipoProducto){
					case 1:
						arrayEntradas.push(nombreProducto);
						escribirMenuHtml();
						break;
					case 2:
						var precioProducto = 0;
						arraySegundos.push([nombreProducto,precioProducto]);
						escribirMenuHtml();
						break;
					case 3:
						if(document.getElementById('txtPrecioProducto').checkValidity()){

							var precioProducto = document.getElementById('txtPrecioProducto').value;
							arrayExtras.push([nombreProducto,precioProducto]);
							escribirMenuHtml();
							document.getElementById('txtPrecioProducto').value = '';
						}
						else{
							document.getElementById('frmMenu').reportValidity();
						}
						break;
					case 4:
						if(document.getElementById('txtPrecioProducto').checkValidity()){
							var precioProducto = document.getElementById('txtPrecioProducto').value;
							arrayBebidas.push([nombreProducto,precioProducto]);
							escribirMenuHtml();
							document.getElementById('txtPrecioProducto').value = '';
						}
						else{
							document.getElementById('frmMenu').reportValidity();
						}
						break;
				}
				document.getElementById('txtNombreProducto').value = '';
				limpiarCanvas();
				draw();
			}
			else{
				document.getElementById('frmMenu').reportValidity();
			}
		}

		function cambiarTipoProducto(tipo){
			tipoProducto = tipo;
			switch (tipo) {
				case 1:
					document.getElementById('lblPrecioProducto').style.display = 'none';
					document.getElementById('lblTextPrecioProducto').style.display = 'none';
					document.getElementById('txtPrecioProducto').required = false;
					break;
			
				case 2:
					document.getElementById('lblPrecioProducto').style.display = 'none';
					document.getElementById('lblTextPrecioProducto').style.display = 'none';
					document.getElementById('txtPrecioProducto').required = false;
					break;
				case 3:
					document.getElementById('lblPrecioProducto').style.display = '';
					document.getElementById('lblTextPrecioProducto').style.display = '';
					document.getElementById('txtPrecioProducto').required = true;
					break;
				case 4:
					document.getElementById('lblPrecioProducto').style.display = '';
					document.getElementById('lblTextPrecioProducto').style.display = '';
					document.getElementById('txtPrecioProducto').required = true;
					break;
			}
		}

		function cambiarPrecio(){
			precioMenu = document.getElementById('inputPrecio').value;
			labelPrecio.innerText = '';
			labelPrecio.innerText = "s/." + precioMenu;
			draw();
		}
		function limpiarSeccionMenu(limpio){
			var menu = itemMenu.cloneNode(true);
			menu.innerText= 'Vacio...';
			selectEntradas.innerHTML = '';
			selectSegundos.innerHTML = '';
			selectExtras.innerHTML = '';
			selectBebidas.innerHTML = '';
			if(!limpio){
				if(arrayEntradas.length == 0){
					selectEntradas.appendChild(menu.cloneNode(true));
				}
				else if(arraySegundos.length == 0){
					selectSegundos.appendChild(menu.cloneNode(true));
				}
				else if(arrayExtras.length == 0){
					selectExtras.appendChild(menu.cloneNode(true));
				}
				else if(arrayBebidas.length == 0){
					selectBebidas.appendChild(menu.cloneNode(true));
				}
			}
		}

		function escribirMenuHtml(){
			limpiarSeccionMenu(true)
			for(var i = 0; i < arrayEntradas.length; i++){
				var item = itemMenu.cloneNode(true);
				item.innerText = arrayEntradas[i];
				selectEntradas.appendChild(item);
			}
			for(var i = 0; i < arraySegundos.length; i++){
				var item = itemMenu.cloneNode(true);
				item.innerText = arraySegundos[i][0];
				selectSegundos.appendChild(item);
			}
			for(var i = 0; i < arrayExtras.length; i++){
				var item = itemMenuConPrecio.cloneNode(true);
				item.innerText = arrayExtras[i][0];
				var spanItem = spanPrecio.cloneNode(true);
				spanItem.innerText = arrayExtras[i][1];
				item.appendChild(spanItem);
				selectExtras.appendChild(item);
			}
			for(var i = 0; i < arrayBebidas.length; i++){
				var item = itemMenuConPrecio.cloneNode(true);
				item.innerText = arrayBebidas[i][0];
				var spanItem = spanPrecio.cloneNode(true);
				spanItem.innerText = arrayBebidas[i][1];
				item.appendChild(spanItem);
				selectBebidas.appendChild(item);
			}
		}

		function limpiarCanvas() {
			var canvasCarta = document.getElementById("canvasCarta");
			const ctx = canvasCarta.getContext('2d');
			ctx.clearRect(0, 0, 1123, 794);
		
		}
		function print(){
			var canvasElement = document.getElementById("canvasCarta");
			var imgData = canvasElement.toDataURL("image/png", 1);
			var pdf = new jsPDF('l');

			pdf.addImage(imgData, 'JPEG', 0, 0);
			pdf.save("download.pdf");
		}
		
		function draw(){
			var BerlinSansFBDemiBold = new FontFace('BerlinSansFBDemiBold', 'url(fonts/BerlinSansFBDemiBold.ttf)');
			BerlinSansFBDemiBold.load().then(function(font){
				document.fonts.add(font);
				var canvasCarta = document.getElementById("canvasCarta");
				if (canvasCarta.getContext) {
				
					var alturaText = 0;
					const ctx = canvasCarta.getContext('2d');

					ctx.drawImage(imagenFondo, -160, -100,1430,900);//530,50,200,200
					//imprimiendo precio del menu
					ctx.fillStyle = "black";
					ctx.font = "bold 20px Arial";
					ctx.fillText("s/.", 245, 190);
					ctx.font = "bold 40px Arial";
					var unidadPrecio = Math.floor(precioMenu);
					var decimaPrecio = ((precioMenu - Math.floor(precioMenu)) * 100).toFixed(0);
					var espacioDecimal = 265;
					ctx.fillText(unidadPrecio+".", espacioDecimal, 190);//250,190
					ctx.font = "bold 20px Arial";
					espacioDecimal += 35;
					if(decimaPrecio == 0){
						decimaPrecio = "00";
					}
					ctx.fillText(decimaPrecio, espacioDecimal, 175);
					
					//escribiendo seccion de la carta entrada
					ctx.font = '800 30px arial';
					ctx.fillStyle = 'black';
					ctx.fillText('ENTRADAS', 95, 270);//270,350
					//dibujando linea de separacion de seccion de la carta entrada
					ctx.beginPath();
					ctx.lineCap="round";
					ctx.lineWidth = 1;
					ctx.moveTo(70, 275);
					ctx.lineTo(300, 275);
					ctx.moveTo(75, 278);
					ctx.lineTo(295, 278);
					ctx.strokeStyle = '#000000';
					ctx.stroke();
					//escribiendo seccion de la carta entrada
					for(var i = 0; i < arrayEntradas.length; i++){
						ctx.font = 'bold 20px arial';
						ctx.fillStyle = 'black';
						alturaText = 310 + (i * 30);//380
						ctx.fillText(arrayEntradas[i], 50, alturaText);//300
					}
					//escribiendo seccion de la carta segundo

					ctx.font = '800 30px BerlinSansFBDemiBold';
					ctx.fillStyle = 'black';
					alturaText += 50;//30
					ctx.fillText('SEGUNDOS', 110, alturaText);
					//dibujando linea de separacion de seccion de la carta segundo
					ctx.beginPath();
					ctx.lineCap="round";
					ctx.lineWidth = 1;
					alturaText += 5;
					ctx.moveTo(70, alturaText);
					ctx.lineTo(310, alturaText);
					ctx.moveTo(75, alturaText + 3);
					ctx.lineTo(305, alturaText + 3);
					ctx.strokeStyle = 'black';
					ctx.stroke();
					alturaText += 35;//25
					//escribiendo seccion de la carta segundo
					for(var i = 0; i < arraySegundos.length; i++){
						ctx.font = 'bold 20px arial';
						ctx.fillStyle = 'black';
						alturaText += (i * 30);
						ctx.fillText(arraySegundos[i][0], 50, alturaText);
					}
					//escribiendo seccion de la carta extras
					ctx.font = '800 30px BerlinSansFBDemiBold';
					ctx.fillStyle = 'black';
					ctx.fillText('EXTRAS', 510, 300);//380
					//dibujando linea de separacion de seccion de la carta extras
					ctx.beginPath();
					ctx.lineWidth = 1;
					ctx.lineCap="round";
					ctx.moveTo(470, 305);
					ctx.lineTo(645, 305);
					ctx.moveTo(475, 308);
					ctx.lineTo(640, 308);
					ctx.strokeStyle = 'black';
					ctx.stroke();
					//escribiendo elementos de la carta extras
					for(var i = 0; i < arrayExtras.length; i++){
						//dibujar elipse para el precio de los extras
						ctx.beginPath();
						ctx.ellipse(702, 333 + (i * 30), 28, 13, 0, 0, 2 * Math.PI);
						ctx.fillStyle = '#C1D92E';
						ctx.fill();
						ctx.strokeStyle = 'green';
						ctx.stroke();
						//escribiendo nombre de los extras
						ctx.font = 'bold 20px arial';
						ctx.fillStyle = 'black';
						ctx.fillText(arrayExtras[i][0], 400,340+ (i * 30));
						
						var tamañoExtra = arrayExtras[i][0].length;
						var guiones = '';
						for(var j = 0; j < (25 - tamañoExtra); j++){
							guiones += '. ';
						}
						//arrayExtras[i][1]
						// obtenieno unidad y decima del precio
						var unidadExtra = Math.floor(arrayExtras[i][1]);
						//var decimaExtra = Math.floor((arrayExtras[i][1] - unidadExtra) * 100);
						var decimaExtra = ((arrayExtras[i][1] - Math.floor(arrayExtras[i][1])) * 100).toFixed(0);
						//imprimiendo puntos
						ctx.fillText(guiones, 400+(tamañoExtra * 11),340+ (i * 30));
						//imprimiendo tipo moneda
						ctx.font = 'bold 10px arial';
						ctx.fillText("S/.", 678,340+ (i * 30));
						//imprimiendo precio unidad
						ctx.font = 'bold 20px arial';
						ctx.fillText(unidadExtra + ".", 690,340+ (i * 30));
						ctx.font = 'bold 10px arial';
						//validando decima en 0
						if (decimaExtra == 0){
							decimaExtra = "00";
						}
						//validando tamaño de la unidad
						if(unidadExtra.toString().length == 1){
							//imprimiendo precio decimal
							ctx.fillText(decimaExtra, 706,332+ (i * 30));//706
						}
						else{
							//imprimiendo precio decimal
							ctx.fillText(decimaExtra, 714,332+ (i * 30));
						}
						
					}
					//escribiendo seccion de la carta bebidas
					ctx.font = '800 30px BerlinSansFBDemiBold';
					ctx.fillStyle = 'black';
					ctx.fillText('BEBIDAS', 880, 50);
					//dibujando linea de separacion de seccion de la carta bebidas
					ctx.beginPath();
					ctx.lineCap="round";
					ctx.lineWidth = 1;
					ctx.moveTo(840, 55);
					ctx.lineTo(1030, 55);
					ctx.moveTo(845, 58);
					ctx.lineTo(1025, 58);
					ctx.strokeStyle = 'black';
					ctx.stroke();
					//escribiendo elementos de la carta bebidas
					for(var i = 0; i < arrayBebidas.length; i++){
						//dibujar elipse para el precio de las bebidas
						ctx.beginPath();
						ctx.ellipse(1082, 83 + (i * 30), 28, 13, 0, 0, 2 * Math.PI);
						ctx.fillStyle = '#C1D92E';
						ctx.fill();
						ctx.strokeStyle = 'green';
						ctx.stroke();
						ctx.font = 'bold 20px arial';
						ctx.fillStyle = 'black';
						ctx.fillText(arrayBebidas[i][0], 780,90+ (i * 30));
						var tamañoBebida = arrayBebidas[i][0].length;
						var guiones = '';
						for(var j = 0; j < (25 - tamañoBebida); j++){
							guiones += '. ';
						}
						//obtenieno unidad y decima del precio
						var unidadBebida = Math.floor(arrayBebidas[i][1]);
						//var decimaBebida = Math.floor((arrayBebidas[i][1] - unidadBebida) * 100);
						var decimaBebida = ((arrayBebidas[i][1] - Math.floor(arrayBebidas[i][1])) * 100).toFixed(0);
						//imprimiendo puntos
						ctx.fillText(guiones, 780+(tamañoBebida * 11),90+ (i * 30));
						//imprimiendo tipo moneda
						ctx.font = 'bold 10px arial';
						ctx.fillText("S/.", 1058,90+ (i * 30));
						//imprimiendo precio unidad
						ctx.font = 'bold 20px arial';
						ctx.fillText(unidadBebida + ".", 1070,90+ (i * 30));
						ctx.font = 'bold 10px arial';
						//validando decima en 0
						if (decimaBebida == 0){
							decimaBebida = "00";
						}
						//validando tamaño de la unidad
						if(unidadBebida.toString().length == 1){
							//imprimiendo precio decimal
							ctx.fillText(decimaBebida, 1086,82+ (i * 30));//1086
						}
						else{
							//imprimiendo precio decimal
							ctx.fillText(decimaBebida, 1094,82+ (i * 30));
						}
					}
					
				} else {
					alert('Your browser does not support the HTML5 canvas tag.');
				}
			});

			

		}
		//window.onload = draw();
		window.addEventListener('load', draw);
		
				
	</script>
</body>
</html>